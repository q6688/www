import{o as e,c as l,w as s,f as t,F as i,g as a,k as o,l as c,J as n,i as r,H as d,b as h,h as u,S as m,z as p,V as f,E as k,I as y,r as w}from"./index-1c6cc45e.js";import{_ as C}from"./_plugin-vue_export-helper.1b428a4d.js";import{r as g}from"./uni-app.es.aacd2b5c.js";const A=C({components:{AfterSelect:C({props:{list:{type:Array,default:()=>[]},index:{type:Number,default:0},useName:{type:String,default:"label"}},emits:["click"],data:()=>({listReal:[]}),watch:{list:{handler(e){console.log(e),this.listReal=e},immediate:!0}},methods:{handleClick(e){this.listReal.forEach((e=>{e.isSel=!1})),e.isSel=!0,this.$emit("click",e,this.index+1)}}},[["render",function(d,h,u,m,p,f){const k=r;return e(),l(k,null,{default:s((()=>[(e(!0),t(i,null,a(p.listReal,(t=>(e(),l(k,{key:t.value,class:o(["show-view-item",{selected:t.isSel}]),onClick:e=>f.handleClick(t)},{default:s((()=>[c(n(t[u.useName]),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})}],["__scopeId","data-v-0897d92c"]])},props:{listReal:{type:Array,default:()=>[]},useName:{type:String,default:"label"}},emits:["click"],data:()=>({listArray:[],selectedArray:[],scrollLeft:0,scrollTop:0}),created(){},methods:{handleClick(e){this.listReal.forEach((e=>{e.isSel=!1})),e.isSel=!0,this.selectedArray.splice(0),this.selectedArray.push(e),this.listArray.splice(0),this.common(e.children)},childClick(e,l){this.listArray.splice(l),this.selectedArray.splice(l,99,e),this.common(e.children,l)},common(e,l){0===this.scrollTop?this.scrollTop=.1:this.scrollTop=0,e&&e.length?(e.forEach((e=>{this.$set(e,"isSel",!1)})),this.listArray.push(e)):this.$emit("click",this.selectedArray),l&&this.$nextTick((()=>{this.scrollLeft=250*l}))}}},[["render",function(p,f,k,y,w,C){const g=r,A=d("after-select"),_=m;return e(),l(_,{"scroll-x":!0,"scroll-y":!0,"scroll-left":w.scrollLeft,"scroll-top":w.scrollTop},{default:s((()=>[h(g,{class:"list-view"},{default:s((()=>[h(g,{class:"show-view first-view"},{default:s((()=>[(e(!0),t(i,null,a(k.listReal,(t=>(e(),l(g,{key:t.value,class:o(["show-view-item",{selected:t.isSel}]),onClick:e=>C.handleClick(t)},{default:s((()=>[c(n(t[k.useName]),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),(e(!0),t(i,null,a(w.listArray,((t,i)=>(e(),l(g,{key:i,class:"show-view"},{default:s((()=>[t.length?(e(),l(A,{key:0,list:t,index:i,"use-name":k.useName,onClick:C.childClick},null,8,["list","index","use-name","onClick"])):u("",!0)])),_:2},1024)))),128))])),_:1})])),_:1},8,["scroll-left","scroll-top"])}],["__scopeId","data-v-de9bdd09"]]);const _=C({data:()=>({list:[]}),onShow:function(e){},onLoad(e){p({url:this.$store.state.APIURL+"/api/schoollist.json",success:e=>{this.list=e.data.list},fail:e=>{console.log(e)}})},methods:{handleClick(e){let l=e[e.length-1];console.log(l),f({title:l.name,confirmText:"确认选择",content:"确认选择的学校(每月只能改一次)",success:e=>{e.confirm?(console.log("用户点击确定"),this.selectschool(l.value)):e.cancel&&console.log("用户点击取消")}})},selectschool(e){p({url:this.$store.state.APIURL+"/api/selectschool.php",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{token:this.$store.state.data.token,schoolid:e},success:e=>{200==e.data.code&&(k({title:"更新成功,正在返回首页"}),y({url:"/pages/index/index"}),setTimeout((()=>{location.reload()}),200),setTimeout((()=>{location.reload()}),1e3)),201==e.data.code&&k({title:e.data.msg})},fail:e=>{console.log(e)}})},onnodeclick(e){}}},[["render",function(t,i,a,o,c,n){const d=g(w("lx-cascade-select"),A),u=r;return e(),l(u,null,{default:s((()=>[h(d,{listReal:c.list,useName:"name",onClick:n.handleClick},null,8,["listReal","onClick"])])),_:1})}]]);export{_ as default};
